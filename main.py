# Standard library imports
import json

# Third party imports


# Local application imports
from Module.AgentCaller import nmapCaller
from Module.kafkaConsumer import nmapScanConsumer
from Module.kafkaConsumer import nmapOutputConsumer
from Module.kafkaConsumer import elasticSendConsumer
from Module.kafkaConsumer import cveSearchScanConsumer
from Module.kafkaConsumer import cveSearchOutputConsumer
from Module.kafkaConsumer import nseScanConsumer
from Module.kafkaConsumer import nseOutputConsumer

import Config.loggingConfig


def main():
    Config.loggingConfig.setupLogging()

    nmap_scan_consumer = nmapScanConsumer.NmapScanConsumers()
    nmap_scan_consumer.start()

    nmap_output_consumer = nmapOutputConsumer.NmapOutputConsumers()
    nmap_output_consumer.start()

    cveSearch_scan_consumer = cveSearchScanConsumer.CVESearchScanConsumers()
    cveSearch_scan_consumer.start()

    cveSearch_output_consumer = cveSearchOutputConsumer.CVESearchOutputConsumers()
    cveSearch_output_consumer.start()

    nse_scan_consumer = nseScanConsumer.NseScanConsumers()
    nse_scan_consumer.start()

    nse_output_consumer = nseOutputConsumer.NSEOutputConsumers()
    nse_output_consumer.start()

    elastic_send_consumer = elasticSendConsumer.ElasticSendConsumers()
    elastic_send_consumer.start()

    nmap_scan_consumer.join()
    nmap_output_consumer.join()
    cveSearch_scan_consumer.join()
    cveSearch_output_consumer.join()
    elastic_send_consumer.join()
    nse_scan_consumer.join()
    nse_output_consumer.join()

if __name__ == "__main__":
    main()