# Standard library imports
import json

# Third party imports
from kafka import KafkaProducer
from Config.config import KafkaConfig, KafkaTopicNames

def genRangeIP(ipRange):
    ipRange = ipRange.split('.')
    res = []
    for ip in range(0, 255):
        _ipRange = ipRange
        _ipRange[len(_ipRange)-1] = str(ip)
        res.append('.'.join(_ipRange))
    return res


if __name__ == "__main__":
    targets = [ 'localhost', 'nmap.org', 'kenh14.vn', 'genk.vn', 
                'scanme.nmap.org', 'github.com', 'youtube.com', 'facebook.com', 
                'vnexpress.net', 'dantri.com.vn', 'ctf.fu-ehc.club', '35.220.248.111', 
                'tinhte.vn', 'thegioididong.com', 'hub.docker.com', 'docker.com', 'github.com', 
                'pornhub.com', 'vlxx.com']

    targets = genRangeIP('192.168.31.x')

    BOOTSTRAPSERVER    = KafkaConfig.BOOTSTRAPSERVER
    NMAPSCAN           = KafkaTopicNames.NMAPSCAN
    producer = KafkaProducer(
                            bootstrap_servers = BOOTSTRAPSERVER,
                            value_serializer=lambda x: json.dumps(x).encode('utf-8'))

    for target in targets:
        data = {"type": "newScan", "target": target}
        producer.send(NMAPSCAN, value = data)
        print("Sent " + str(data))
        
    producer.flush()