import json
from kafka import KafkaProducer

class Procuder():
    def __init__(self):
        self.producer = KafkaProducer(
            bootstrap_servers=['localhost:9092'],
            value_serializer=lambda x: json.dumps(x).encode('utf-8'))

    def sendNmap(self, data):
        self.producer.send('nmapScan', value=data)
        self.producer.flush()

def main():
    p = Procuder()
    p.sendNmap({"target": "test1", "action": "full"})

if __name__ == "__main__":
    main()