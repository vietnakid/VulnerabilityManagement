# Standard library imports
import json

# Third party imports
from kafka import KafkaProducer

# Local application imports
# from Config.config import KafkaTopicNames, KafkaConfig

# class NmapScanProducers():
#     def __init__(self, data):
#         self.producer = KafkaProducer(
#                             bootstrap_servers = KafkaConfig.BOOTSTRAPSERVER,
#                             value_serializer=lambda x: json.dumps(x).encode('utf-8'))
#         self.data = data

#     def sendDataToQueue(self):
#         self.producer.send(KafkaTopicNames.NMAPSCAN, value = self.data)
#         self.producer.flush()
    

if __name__ == "__main__":
    #Edit target in here
    targets = [ 'localhost', 'nmap.org', 'kenh14.vn', 'genk.vn', 
                'scanme.nmap.org', 'github.com', 'youtube.com', 'facebook.com', 
                'vnexpress.net', 'dantri.com.vn', 'ctf.fu-ehc.club', '35.220.248.111', 
                'tinhte.vn', 'thegioididong.com', 'hub.docker.com', 'docker.com', 'github.com', 
                'pornhub.com', 'vlxx.com']

    BOOTSTRAPSERVER    = 'localhost:9092'
    NMAPSCAN           = 'nmapScan'
    producer = KafkaProducer(
                            bootstrap_servers = BOOTSTRAPSERVER,
                            value_serializer=lambda x: json.dumps(x).encode('utf-8'))

    for target in targets:
        data = {"type": "newScan", "target": target}
        print("Sent " + str(data))
        producer.send(NMAPSCAN, value = data)
        
    producer.flush()