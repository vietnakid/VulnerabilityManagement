# Standard library imports
import json

# Third party imports
from kafka import KafkaProducer

# Local application imports
from Config.config import KafkaTopicNames, KafkaConfig

class NseScanProducers():
    def __init__(self, data):
        self.producer = KafkaProducer(
                            bootstrap_servers = KafkaConfig.BOOTSTRAPSERVER,
                            value_serializer=lambda x: json.dumps(x).encode('utf-8'))
        self.data = data

    def sendDataToQueue(self):
        self.producer.send(KafkaTopicNames.NSESCAN, value = self.data)
        self.producer.flush()