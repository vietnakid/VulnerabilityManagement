# Standard library imports
import json
import threading
import logging

# Third party imports
from kafka import KafkaProducer

# Local application imports
from Config.config import KafkaTopicNames, KafkaConfig

class nmapOutputProducers():
    def __init__(self, data):
        self.producer = KafkaProducer(
                            bootstrap_servers = KafkaConfig.BOOTSTRAPSERVER,
                            value_serializer=lambda x: json.dumps(x).encode('utf-8'))
        self.data = data

    def sendData(self):
        print(self.data)
        print(KafkaConfig.BOOTSTRAPSERVER)
        print(KafkaTopicNames.NMAPOUTPUT)
        self.producer.send(KafkaTopicNames.NMAPOUTPUT, value = self.data)
        self.producer.flush()